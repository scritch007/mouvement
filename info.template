<html>
	<head>
		<title>Mon mouvement</title>
	</head>
	<body>
<script>


var parameters = []

function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
      hash = hashes[i].split('=');
      vars.push(hash[0]);
      no_plus = hash[1].split('+');
      vars[hash[0]] = no_plus.join(' ');
    }
    return vars;
}


function getparameters()
{
	var params = getUrlVars();
	regions = document.getElementById("regions");
	region = params['region'];
	if( null !== region)
	{
		for( var i=0; i< regions.length; i++)
		{
			if ( regions[i].value === region)
			{
				regions.selectedIndex = i;
				break;
			}
		}
	}
	address_input = document.getElementById("address");
	address = params['address'];

	address_input.value = address;	
}

function combo()
{
	theinput = document.getElementById("regions");
	var idx = theinput.selectedIndex;
	var content = theinput.options[idx].value;
	//getparameters();
	insertParam("region", content);

	address_input = document.getElementById("address");
	
	insertParam("address", address_input.value);

    	document.location.search = parameters; 
}


function insertParam(key, value)
{
    value = value.split(' ');
    key = escape(key); value = escape(value.join('+'));

    var kvp = parameters;

    var i=kvp.length; var x; while(i--) 
    {
        x = kvp[i].split('=');

        if (x[0]==key)
        {
                x[1] = value;
                kvp[i] = x.join('=');
                break;
        }
    }

    if(i<0) {kvp[kvp.length] = [key,value].join('=');}

    //this will reload the page, it's likely better to store this until finished
    parameters = kvp.join('&');
}
window.onload=getparameters;
</script>

   		<select id="regions" >
		{% for item in regions %}
   			<option> {{ item }} </option>
		{% end %}
   		</select>
		<label>adresse</label>
		<input type="text" id="address"/>

		<button type="button" onclick="combo()"> Ok </button>


	</body>

</html>
